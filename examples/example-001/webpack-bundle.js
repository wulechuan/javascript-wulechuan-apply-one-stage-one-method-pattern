!function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var o={};t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){function n(e){function t(){h("Route 1 > Stage 1")}function o(){h("Route 1 > Stage 2")}function n(){h("Route 2 > Stage 1")}function a(){h("Route 2 > Stage 3")}function s(){h("Shared Method [ Note that the two routes are even sharing the method name! ]")}function i(){return l++,"\n\t"+u+" "+l}function h(e){console.log("\n\nInvoking method: "+e+":",i(),"\n\n")}var u="secret",l=0;this.name=e,this.methodInNeitherRoutes=function(){console.log("I alwasy exist.",i())},this.method_1_1=function(){console.log('You will never be able to use me, because the "aStagesRoute1" will overwrite me')};var d=new r(this,"en-US"),g=new r(this,"en-US");d.addStage(t,{"en-US":"method_1_1"}),d.addStage(o,{"en-US":"method_1_2"}),d.addStage(s,{"en-US":"method_shared"}),g.addStage(n,{"en-US":"method_2_1"}),g.addStage(s,{"en-US":"method_shared"}),g.addStage(a,{"en-US":"method_2_3"})}function a(e,t){t=t&&"string"==typeof t?' "'+t.trim()+'"':"";var o=[""];for(var n in e){"function"==typeof e[n]&&o.push(n)}console.log("Object"+t+" has these methods:",o.join("\n\t"),"\n\n")}var r=o(1),s=new n("wulechuan");window.WulechuanApplyStagesPatternToMethodsOwner=r,window.a=s,console.group("At beginning"),a(s,"a"),console.groupEnd(),s.method_1_1(),console.group("After invocation of route1 method1"),a(s,"a"),console.log('Note that the "method_1_1" disappears, while the "method_1_2" appears.'),console.groupEnd(),s.method_2_1(),console.group("After invocation of route2 method1"),a(s,"a"),console.groupEnd(),s.method_shared(),console.group("After invocation of shared method in route 2"),a(s,"a"),console.groupEnd(),s.method_1_2(),console.group("After invocation of route1 method2"),a(s,"a"),console.groupEnd(),s.method_2_3(),console.group("After invocation of route2 method3"),a(s,"a"),console.groupEnd(),console.group("Finally let's try to invoke the shared method, **AGAIN**!","\nBecause we had thought that the version in the route 1 were preserved.","\nBut that's simply **NOT** the case. And an error will thrown.","\nBecause the same method name should always mean the exactly the same thing.",'\nSince the "method_shared" method has been invoked via the route 2,',"\nIt is our responsibility to make sure that there are no route meaning chaos.","\nThe example above is simply **not right**.","\n\nBesides, generally, although we can design more than one routes for an object,","\nor even share the same function as the stepping method of each route,","\nwe shall not mixing up the execution of these routes,","\nOtherwise, why routes?"),s.method_shared(),console.groupEnd()},function(e,t,o){e.exports=o(2)},function(e,t){function o(e,t){function o(e){return Array.isArray(e)&&e.length>0}function n(t,o,n){if("function"!=typeof t)throw TypeError('A so-called stage is basically a function, with some associated aliases just for conveniences, which not only does some demonded work but also exposes subsequence stages and hides past stages for a given stages operator. Among them, the demonded work is provided by you developer via the first argument, So, when defining a stage, the first argument must be a function, \nwhile the provided value was of type "'+typeof t+'".');2===arguments.length&&(n=o,o=!1);var r=a(n),s=y.length;r.stageIndex=s,r.usingLanguage="";var i={actionAliases:r,allowsToSkip:o,action:function(){if(c)return s===y.length-1?void 0:e;S=s;var o=t.apply(e,arguments);return h(),s===y.length-1?o:e}};return y.push(i),i}function a(e){var t={},n=!1;if("string"==typeof e){if(!e)throw RangeError("An alias for a method must not be an empty string");if(!f)throw TypeError("Before the preferred language is set, the language an alias of a method is in must be specified explicitly.");var a={};a[f]=[e],e=a}else if(!e||"object"!=typeof e)throw TypeError("The action aliases argument must be an object, containing at least one alias which is marked as in a specified language.");for(var r in e){var s=e[r];if(s&&"string"==typeof s&&(s=[s],e[r]=s),o(s)){for(var i=[],h=0;h<s.length;h++){var u=s[h];u&&"string"==typeof u&&i.push(u)}i.length<1?console.warn('Non of the entries in language "'+r+'" are valid.'):(n=!0,t[r]=i,!b[r]&&(_.push(r),b[r]=!0))}}if(!n)throw TypeError("At least one alias is required for a stage action to publish as a method.");return t}function r(e,t){var n=e[t];if(o(n))return e.usingLanguage=t,n;var a,r=!1;for(a in e)if(n=e[a],o(n)){r=!0,e.usingLanguage=a;break}if(!r)throw ReferenceError("No valid aliases in any language for stage "+e.stageIndex+"!");return console.warn("For stage",e.stageIndex,', none of the aliases is in the preferred language ("'+t+'").','\nInstead, aliases in "'+a+'" are exposed as methods.'),n}function s(e){if(!e)throw TypeError("Must specify the natural language to use.");f=e,l()}function i(){y[0].action.apply(e,arguments)}function h(){u(),d(S+1)}function u(){for(var t=0;t<=S;t++)for(var o=y[t].actionAliases,n=o[o.usingLanguage],a=0;a<n.length;a++){var r=n[a];delete e[r]}}function l(){y.length<1||f&&(w[v]=i,g(0,1))}function d(e){var t,o=y.length;for(t=e;t<y.length-1;t++)if(!y[t].allowsToSkip){o=t+1;break}g(e,o)}function g(t,o){for(var n=t;n<o;n++)for(var a=y[n],s=a.action,i=r(a.actionAliases,f),h=0;h<i.length;h++){var u=i[h];e[u]=s}}var c,f,p="addStage",m="setPreferredNaturalLanguageTo",v="startFromFirstStage",w=this,y=[],S=NaN,_=[],b={};t&&"string"==typeof t&&(f=t),w[p]=function(){c=!1,n.apply(w,arguments),w[p]=n,w[m]=s,l()},w[m]=s,w.abort=function(){S>=0?(c=!0,console.error("The process is stopped at stage",S)):console.info("The execution process has not started yet.")}}e.exports=o}]);